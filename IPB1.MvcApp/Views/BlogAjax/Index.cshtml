@model List<TblBlog>
@{
	ViewData["Title"] = "Blog List";
	int count = 0;
}

<h1>Blog</h1>

<a href="/Blog/Create" class="btn btn-success">New</a>

<table class="table">
	<thead>
		<tr>
			<th></th>
			<th>
				No.
			</th>
			<th>
				Title
			</th>
			<th>
				Author
			</th>
			<th>
				Content
			</th>
		</tr>
	</thead>
	<tbody>
		@foreach (var item in Model)
		{
			<tr>
				<td>
					<a href="/BlogAjax/Edit/@(item.BlogId)" class="btn btn-warning">Edit</a>
					<button type="button" data-blog-id="@(item.BlogId)" class="btn btn-danger btn-delete">Delete</button>
				</td>
				<td>@(++count)</td>
				<td>@item.BlogTitle</td>
				<td>@item.BlogAuthor</td>
				<td>@item.BlogContent</td>
			</tr>
		}
	</tbody>
</table>
@section scripts {
	<script>
		$(".btn-delete").click(function (e){
			const id = $(this).data("blog-id");
			// alert(id);

			if (!confirm("Are you sure you want to delete this blog?")) {
				return;
			}

			const blogRequest = {
				BlogId : id
			}
			 $.ajax({
				type: "POST",
				url: "/BlogAjax/Delete",
				data: { request: blogRequest },
				success: function (response) {
					alert(response.Message);
					if (response.IsSuccess) {
						location.reload();
					}
				},
				error: function () {
					alert("Error deleting blog.");
				}
			});
		})
	</script>
}